# Chainweb Node Configuration (Compacted Database)
# Optimized for Flux deployment with reduced storage requirements

databaseDirectory: /data/chainweb-db
resetChainDatabases: false

# IMPORTANT: Required for compacted database snapshots
fullHistoricPactState: false

chainweb:
  chainwebVersion: mainnet01

  # P2P network settings
  p2p:
    peer:
      interface: '*'
      hostaddress:
        hostname: "0.0.0.0"
        port: 1789
      certificateChain: null
      certificateChainFile: null
      key: null
      keyFile: null
    peerDbFilePath: null
    maxPeerCount: 1000
    maxSessionCount: 10
    sessionTimeout: 300
    private: false
    ignoreBootstrapNodes: false

  # Rate limiting
  throttling:
    local: 10
    mining: 10
    global: 1000
    putPeer: 30

  # Mining configuration (disabled by default, enable via env vars)
  mining:
    coordination:
      enabled: false
      mode: private
      limit: 1200
      miners: []
    nodeMining:
      enabled: false

  # Transaction and mempool settings
  transactionIndex:
    enabled: true
    configuration: {}
  mempoolP2p:
    enabled: true
    configuration:
      pollInterval: 30
      maxSessionCount: 6
      sessionTimeout: 300
  reintroTxs: true

  # Chain database settings
  cuts:
    # IMPORTANT: Must be disabled for compacted database snapshots
    pruneChainDatabase: none
    fetchTimeout: 50000000
    initialCutHeightLimit: null

  # API features
  headerStream: true
  allowReadsInLocal: true
  rosetta: false

# Logging configuration
logging:
  telemetryBackend:
    enabled: true
    configuration:
      handle: stderr
      color: auto
      format: text
  backend:
    handle: stderr
    color: auto
    format: text
  logger:
    log_level: warn
    queue_size: 1000
    exception_wait: 1000
    exit_timeout: 1000000
    scope: []
    exception_limit: 10
    policy: discard
  filter:
    rules: []
    default: warn
  clusterId: flux-chainweb-node
